import{r as i,n as T,w as Y,j as e,x as Z,y as H,A as ee,P as se,a0 as te,a1 as re,D as ae}from"./vendor.js";import{a as q,D as oe}from"./DashboardLayout.js";import{u as B}from"./index.js";import{P as ie}from"./ProductCard.js";import{u as ne}from"./useProdotti.js";import"./logo2.js";function le({onClose:o,onSuccess:m}){const u=H(),p=ee(),[f,b]=i.useState(!1),g=async h=>{if(h?.preventDefault?.(),!(!u||!p))try{b(!0);const{error:r}=await u.confirmPayment({elements:p,redirect:"if_required"});if(r)throw r;T.success("Pagamento completato!"),m?.(),o?.()}catch(r){T.error(r?.message||"Errore durante il pagamento")}finally{b(!1)}};return e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsx("div",{className:"rounded-md border border-gray-200 p-3",children:e.jsx(se,{options:{layout:"tabs"}})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:o,className:"px-3 py-1.5 rounded-md border",children:"Annulla"}),e.jsx("button",{type:"submit",disabled:f||!u,className:"px-3 py-1.5 rounded-md bg-blue-600 text-white disabled:opacity-60",children:f?"Elaborazioneâ€¦":"Paga ora"})]})]})}function ce({open:o,onClose:m,onSuccess:u,amount:p,emailCliente:f,cartItems:b=[],shippingCost:g=0,notes:h=""}){const{user:r}=B(),[a,S]=i.useState(""),[y,w]=i.useState(""),[P,N]=i.useState(!1),j=i.useMemo(()=>Number(p||0),[p]);i.useEffect(()=>{o&&(async()=>{try{const{data:v}=await q.get("/api/stripe/public-key");S(v?.publicKey||"")}catch{S("")}})()},[o]),i.useEffect(()=>{!o||!a||(async()=>{try{N(!0);const v=b.map(C=>({id:C.id,quantita:C.qty||1})),O={amount:j,userId:r?.idDealer||r?.dealerId||r?.id,dealerId:r?.dealerId||r?.idDealer||void 0,carrello:v,emailCliente:f||r?.email,speseSpedizione:g,noteOrdine:h||"",metadata:{orderType:"PROD",dealerId:String(r?.dealerId||r?.idDealer||"")}},{data:t}=await q.post("/api/stripe/create-product-payment-intent",O),I=t?.client_secret;if(!I)throw new Error("client_secret non ricevuto");w(I)}catch(v){T.error(v?.response?.data?.error||v?.message||"Errore creazione pagamento"),m?.()}finally{N(!1)}})()},[o,a,j,f,b,g,h,r?.dealerId,r?.idDealer,r?.id,r?.email]);const k=i.useMemo(()=>a?Y(a):null,[a]);return o?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-5",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pagamento Ordine"}),a?.startsWith("pk_test_")&&e.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded bg-yellow-100 text-yellow-800 border border-yellow-200",children:"TEST MODE"})]}),e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:["Totale da pagare: ",e.jsx("span",{className:"font-semibold",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(j)})]}),!k||!y?e.jsx("div",{className:"text-sm text-gray-600",children:P?"Preparazione pagamentoâ€¦":"Inizializzazioneâ€¦"}):e.jsx(Z,{stripe:k,options:{clientSecret:y,appearance:{theme:"stripe"},locale:"it"},children:e.jsx(le,{onClose:m,onSuccess:u})},y)]})}):null}function de({items:o,onIncrease:m,onDecrease:u,onRemove:p,paymentMethod:f,setPaymentMethod:b,transportMethod:g,setTransportMethod:h,notes:r,setNotes:a,onCheckout:S,hasNonFastwebSim:y=!1}){const{user:w}=B?.()||{user:null},[P,N]=i.useState(!1),j=i.useMemo(()=>{if(!(g==="corriere"||g==="Invio da Sede")||!o.some(E=>Number(E.speseSpedizione??E.SpeseSpedizione??0)>0))return 0;const C=o.reduce((E,A)=>{const D=Number(A.speseSpedizione??A.SpeseSpedizione??0);return Number.isFinite(D)?Math.max(E,D):E},0);return console.log(`[CART] Metodo: ${g}, Spese trasporto: â‚¬${C}`),C},[g,o]),k=i.useMemo(()=>o.reduce((t,I)=>t+(I.price||0)*(I.qty||1),0),[o]),v=i.useMemo(()=>k+j,[k,j]),O=()=>{if(f==="card"){N(!0);return}S?.()};return e.jsxs("section",{className:"bg-white rounded-xl p-4 sm:p-6 sticky top-24",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Carrello"}),e.jsxs("div",{className:"divide-y divide-gray-100 border border-gray-100 rounded-xl overflow-hidden",children:[o.length===0&&e.jsx("div",{className:"p-4 text-sm text-gray-500 text-center",children:"Il carrello Ã¨ vuoto"}),o.map(t=>e.jsxs("div",{className:"flex flex-col gap-2 p-3 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-12 h-12 object-contain rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:t.title}),e.jsx("div",{className:"text-xs text-gray-500",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(t.price)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(t.id),className:"h-8 w-8 inline-flex items-center justify-center rounded-md border border-gray-200 text-gray-700 hover:bg-gray-50",children:"-"}),e.jsx("span",{className:"w-6 text-center text-sm font-semibold",children:t.qty}),e.jsx("button",{onClick:()=>m(t.id),className:`h-8 w-8 inline-flex items-center justify-center rounded-md border text-sm ${Number(t.idOfferta)===149&&t.qty>=1?"border-gray-300 text-gray-400 cursor-not-allowed":"border-gray-200 text-gray-700 hover:bg-gray-50"}`,disabled:Number(t.idOfferta)===149&&t.qty>=1,children:"+"})]}),e.jsx("button",{onClick:()=>p(t.id),className:"ml-2 text-red-600 text-sm hover:underline",children:"Rimuovi"})]}),Number(t.idOfferta)===149&&e.jsx("div",{className:"pl-15 sm:pl-16",children:e.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 border border-amber-200 rounded-md px-2 py-1",children:"âš ï¸ SIM ILIAD: massimo 1 pack per ordine"})})]},t.id))]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Metodo di pagamento"}),y&&e.jsx("div",{className:"mb-3 p-3 bg-amber-50 border border-amber-300 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-amber-600 text-lg",children:"âš ï¸"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-semibold text-amber-900 mb-1",children:"ATTENZIONE"}),e.jsxs("p",{className:"text-xs text-amber-800",children:["Il carrello contiene SIM non-Fastweb. Il pagamento Ã¨ consentito ",e.jsx("strong",{children:"solo con carta di credito"}),"."]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer ${f==="card"?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:"card",checked:f==="card",onChange:()=>b("card")}),e.jsx("span",{className:"text-sm text-gray-800",children:"Carta di credito"})]}),e.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg ${y?"opacity-50 cursor-not-allowed bg-gray-100 border-gray-300":`cursor-pointer ${f==="sepa"?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`}`,title:y?"Bonifico non disponibile per SIM non-Fastweb":"",children:[e.jsx("input",{type:"radio",name:"payment",value:"sepa",checked:f==="sepa",onChange:()=>b("sepa"),disabled:y}),e.jsx("span",{className:"text-sm text-gray-800",children:"Bonifico SEPA"}),y&&e.jsx("span",{className:"ml-auto text-xs text-gray-500",children:"(Non disponibile)"})]})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Metodo di trasporto"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:e.jsxs("label",{className:`flex items-center justify-between p-3 border rounded-lg cursor-pointer ${g==="corriere"?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"flex items-center gap-2 text-sm text-gray-800",children:"Corriere"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(j)}),e.jsx("input",{type:"radio",name:"transport",value:"corriere",checked:g==="corriere",onChange:()=>h("corriere")})]})]})})]}),o.some(t=>Number(t.idOfferta)===446)&&e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Codice speciale"}),o.filter(t=>Number(t.idOfferta)===446).map(t=>{const I=!(t.customCode&&t.customCode.trim());return e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-800 mb-1 uppercase tracking-wide",children:"Codice speciale (cim-flora-kim-dXXX)"}),e.jsxs("div",{className:"mb-2 text-xs text-red-600 font-medium flex items-center gap-1",children:[e.jsx("span",{className:"inline-flex h-4 w-4 items-center justify-center rounded-full bg-red-100 text-red-600 text-[10px] font-bold",children:"!"}),e.jsx("span",{children:"Campo obbligatorio per completare l'ordine."})]}),e.jsx("input",{type:"text",value:t.customCode||"",onChange:C=>{const E=new CustomEvent("agentcart:updateItem",{detail:{id:t.id,patch:{customCode:C.target.value}}});window.dispatchEvent(E)},placeholder:"cim-flora-kim-d123",className:`w-full rounded-lg text-sm ${I?"border-2 border-red-400 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`})]},`code-${t.id}`)})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Note per l'ordine"}),e.jsx("textarea",{value:r,onChange:t=>a(t.target.value),rows:3,placeholder:"Aggiungi eventuali indicazioni per la spedizione o la fatturazione...",className:"w-full rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm"})]}),e.jsxs("div",{className:"mt-5 border-t pt-4 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotale"}),e.jsx("span",{className:"font-medium",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(k)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Spedizione"}),e.jsx("span",{className:"font-medium",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(j)})]}),e.jsxs("div",{className:"flex justify-between text-base pt-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Totale"}),e.jsx("span",{className:"font-bold text-gray-900",children:new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(v)})]})]}),e.jsx("button",{type:"button",onClick:O,disabled:o.length===0,className:"mt-5 w-full inline-flex items-center justify-center rounded-lg bg-blue-600 px-4 py-3 text-white text-sm font-semibold shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Procedi all'acquisto"}),e.jsx(ce,{open:P,onClose:()=>N(!1),onSuccess:()=>{try{const t={total:v,items:o};window.dispatchEvent(new CustomEvent("order-paid",{detail:t}))}catch{}N(!1)},amount:v,emailCliente:w?.email,cartItems:o,shippingCost:j,notes:r})]})}function me(){const[o,m]=i.useState([]),[u,p]=i.useState(!1),[f,b]=i.useState(null),g=r=>(r||[]).map(a=>{const S=Number(a.id??a.IDTelefono??0)||0,y=Number(a.priceCents??a.price*100??0)||0,w=Number(a.price??y/100??0);return{id:String(S||a._id||""),idOfferta:S,title:String(a.title??a.Titolo??"Telefono"),description:String(a.description??a.Descrizione??""),price:w,priceCents:y,image:a.image||a.ImmagineURL||"/vite.svg",speseSpedizione:Number(a.speseSpedizione??a.SpeseSpedizione??0),marca:a.Marca||"",modello:a.Modello||"",specifiche:a.specifiche||null,type:"telefono",raw:a}}),h=i.useCallback(async()=>{b(null),p(!0);try{const r=await q.get("/api/telefoni"),a=Array.isArray(r.data)?r.data:r.data?.data||[];m(g(a))}catch(r){r.response?.status===403?(m([]),b(null)):b(r.normalized||r)}finally{p(!1)}},[]);return i.useEffect(()=>{h()},[h]),{data:o,loading:u,error:f,refetch:h}}function he(){const{user:o}=B(),[m,u]=i.useState([]),[p,f]=i.useState("card"),[b,g]=i.useState("corriere"),[h,r]=i.useState(""),a=i.useRef(null),[S,y]=i.useState(""),[w,P]=i.useState({open:!1,ordineId:null,totale:0}),[N,j]=i.useState("sim"),k=[147,251,212],{data:v=[],loading:O,error:t,refetch:I}=ne("SIM"),{data:C=[],loading:E,error:A,refetch:D}=me();console.log("=== PAGINA PRODUCTS CARICATA ===");const M=localStorage.getItem("token");if(console.log("[DEBUG Products] Token presente:",!!M),M)try{const c=M.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),l=c+"=".repeat((4-c.length%4)%4),n=JSON.parse(atob(l));console.log("[DEBUG Products] JWT payload diretto:",n),console.log("[DEBUG Products] idGruppo nel token:",n.idGruppo),console.log("[DEBUG Products] dealerId nel token:",n.dealerId)}catch(s){console.error("[DEBUG Products] Errore decodifica token:",s)}console.log("[DEBUG] User object:",JSON.stringify(o,null,2)),console.log("[DEBUG] user.idGruppo:",o?.idGruppo),console.log("[DEBUG] user.role:",o?.role);const F=o?.role==="dealer"&&o?.idGruppo===1;console.log("[DEBUG] canAccessTelefoni:",F);const _=F,$=N==="sim"?v:C,R=N==="sim"?O:E,U=N==="sim"?t:A,X=N==="sim"?I:D,L=i.useMemo(()=>m.some(s=>{const c=Number(s.idOfferta||0),l=c>0&&c<500,n=k.includes(c);return l&&!n}),[m]);i.useEffect(()=>{L&&p==="sepa"&&(f("card"),T.error("Le SIM non-Fastweb possono essere pagate solo con carta di credito"))},[L,p]),i.useEffect(()=>{const s=c=>{const{id:l,patch:n}=c.detail||{};!l||!n||u(d=>d.map(x=>x.id===l?{...x,...n}:x))};return window.addEventListener("agentcart:updateItem",s),()=>window.removeEventListener("agentcart:updateItem",s)},[]),i.useEffect(()=>{const s=c=>{const{total:l}=c.detail||{};u([]),r(""),T.success(`Ordine confermato. Totale pagato: ${new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(Number(l||0))}`)};return window.addEventListener("order-paid",s),()=>window.removeEventListener("order-paid",s)},[]);const z=S.trim().toLowerCase(),G=i.useMemo(()=>{const s=Array.isArray($)?$:[];return z?s.filter(c=>(c.title||"").toLowerCase().includes(z)||(c.id||"").toLowerCase().includes(z)):s},[$,z]),K=s=>{const c={id:s.id,idOfferta:Number(s.idOfferta||0),title:s.title,price:s.price,priceCents:s.priceCents,image:s.image,speseSpedizione:Number(s.speseSpedizione??0)},l=Number(s.idOfferta)===149;u(n=>{const d=n.findIndex(x=>x.id===s.id);if(d!==-1){if(l&&n[d].qty>=1)return T.error("SIM ILIAD: Ã¨ possibile acquistare massimo 1 pack per ordine"),n;const x=[...n];return x[d]={...x[d],qty:(x[d].qty||1)+1},x}return[...n,{...c,qty:1}]}),typeof window<"u"&&!window.matchMedia("(min-width: 1280px)").matches&&setTimeout(()=>{a.current?.scrollIntoView({behavior:"smooth",block:"start"})},0)},W=s=>u(c=>c.map(l=>l.id===s?Number(l.idOfferta)===149&&l.qty>=1?(T.error("SIM ILIAD: Ã¨ possibile acquistare massimo 1 pack per ordine"),l):{...l,qty:(l.qty||1)+1}:l)),J=s=>u(c=>c.map(l=>l.id===s?{...l,qty:Math.max(1,(l.qty||1)-1)}:l)),Q=s=>u(c=>c.filter(l=>l.id!==s)),V=()=>{for(const n of m)if(Number(n.idOfferta)===446){const d=(n.customCode||"").toString().trim();if(!/^cim-flora-kim-d\d{1,3}$/.test(d)){alert("Per il prodotto speciale (ID 446) Ã¨ necessario un codice valido nel formato cim-flora-kim-dXXX");return}}const s=m.reduce((n,d)=>n+(d.price||0)*(d.qty||1),0),c=b==="corriere"?m.reduce((n,d)=>{const x=Number(d.speseSpedizione??d.SpeseSpedizione??0);return Number.isFinite(x)?Math.max(n,x):n},0):0,l=s+c;if(p==="sepa"){const n=m.map(d=>({id:d.id,quantita:d.qty||1}));q.post("/api/order/bonifico",{carrello:n,emailCliente:o?.email||"",speseSpedizione:c,noteOrdine:h||""}).then(({data:d})=>{const x=d?.idOrdineProdotto;u([]),r(""),T.success("Ordine registrato. Attendi la ricezione della mail con i dettagli per il bonifico."),P({open:!0,ordineId:x,totale:s})}).catch(d=>{const x=d?.response?.data?.error||d?.message||"Errore invio ordine bonifico";T.error(x)});return}alert(`Checkout
Articoli: ${m.length}
Pagamento: ${p}
Trasporto: ${b}
Totale: â‚¬${l.toFixed(2)}
Note: ${h||"-"}
(Placeholder)

`+m.map(n=>`- ${n.title} x${n.qty}${Number(n.idOfferta)===446?` (codice: ${n.customCode||"-"})`:""}`).join(`
`))};return e.jsx(oe,{children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Prodotti"}),e.jsxs("button",{onClick:()=>a.current?.scrollIntoView({behavior:"smooth"}),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 lg:hidden",children:[e.jsx(te,{className:"w-5 h-5"}),e.jsxs("span",{children:["Carrello (",m.length,")"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>j("sim"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="sim"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"SIM"})]})}),_&&e.jsx("button",{onClick:()=>j("telefoni"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="telefoni"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Telefoni"})]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("section",{className:"bg-white rounded-xl p-4 sm:p-6 h-[calc(100vh-200px)] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Catalogo Prodotti"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",placeholder:"Cerca prodotto...",className:"w-48 sm:w-64 rounded-lg border-gray-300 focus:border-blue-500 focus:ring-blue-500 text-sm",value:S,onChange:s=>y(s.target.value)})})]}),N==="telefoni"&&e.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"text-2xl",children:"ðŸ’°"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-green-800 mb-1",children:"PROMOZIONE TELEFONI + SIM FASTWEB"}),e.jsxs("p",{className:"text-sm text-green-700",children:["Per ogni telefono venduto in abbinamento ad una SIM Fastweb ",e.jsx("strong",{children:"(modalitÃ  one shot)"}),", riceverai una nota di credito del ",e.jsx("strong",{children:"5%"})," sul valore del dispositivo, ",e.jsx("strong",{children:"oltre al compenso previsto dal piano incentivazione"}),"."]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-1 sm:pr-2",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6",children:[R&&[...Array(6)].map((s,c)=>e.jsx("div",{className:"h-40 bg-gray-100 rounded-2xl animate-pulse"},`sk-${c}`)),U&&e.jsxs("div",{className:"col-span-full text-sm text-red-600 flex items-center justify-between",children:[e.jsx("span",{children:"Errore nel caricamento prodotti."}),e.jsx("button",{onClick:X,className:"ml-3 px-3 py-1.5 rounded bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Riprova"})]}),!R&&!U&&G.map(s=>e.jsx(ie,{image:s.image,title:s.title.toUpperCase(),price:s.price,originalPrice:s.originalPrice,discountPct:s.discountPct,idOfferta:s.idOfferta,onSelect:()=>K(s)},s.id)),!R&&!U&&G.length===0&&e.jsx("div",{className:"col-span-full text-sm text-gray-500",children:"Nessun prodotto trovato"})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"sticky top-6",ref:a,children:e.jsx(de,{items:m,onIncrease:W,onDecrease:J,onRemove:Q,paymentMethod:p,setPaymentMethod:f,transportMethod:b,setTransportMethod:g,notes:h,setNotes:r,onCheckout:V,hasNonFastwebSim:L})})})]}),w.open&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg mx-4 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Ordine registrato"}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Il tuo ordine Ã¨ stato registrato con successo. VerrÃ  evaso non appena riceveremo l'accredito del bonifico."}),e.jsx("p",{className:"text-sm text-gray-900 font-medium mb-4",children:"Per completare l'acquisto, effettua il bonifico. IBAN: IT31Y0306915936100000061953 intestato a KIM S.r.l.s."}),e.jsxs("div",{className:"rounded-lg border border-gray-200 p-4 mb-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"N. Ordine:"})," #",w.ordineId]}),e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:"Totale:"})," ",new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR"}).format(Number(w.totale||0))]}),e.jsx("div",{className:"text-sm text-amber-700 mt-2",children:"Stato: In attesa di pagamento"})]}),e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Dati per il bonifico"}),e.jsxs("div",{className:"rounded-lg bg-gray-50 border border-gray-200 p-4 text-sm text-gray-800 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"IBAN:"})," IT31Y0306915936100000061953"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Banca:"})," INTESA SAN PAOLO"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Intestatario:"})," Kim s.r.l.s"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Causale:"})," Ordine Prodotti ",w.ordineId?`#${w.ordineId}`:""," Ragione sociale: ",o?.ragioneSociale||""]})]}),e.jsx("div",{className:"flex justify-end mt-5",children:e.jsx("button",{onClick:()=>P({open:!1,ordineId:null,totale:0}),className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700",children:"Ho capito"})})]})})]})})}export{he as default};
