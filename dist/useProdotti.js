import{r}from"./vendor.js";import{a as b}from"./DashboardLayout.js";function y(i="SIM",s=11){const[m,n]=r.useState([]),[S,c]=r.useState(!1),[P,d]=r.useState(null),g=e=>(e||[]).map(t=>{const u=Number(t.IDOfferta??t.id??t.ID??0)||0,a=Number(t.prezzo??t.Crediti??t.price??0)||0,z=a/100,h=Number(t.FixedDiscountPct??t.fixedDiscountPct??0)||0,l=Math.min(Math.max(h,0),100),f=Math.round(a*(100-l)/100),D=f/100;return{id:String(u||t._id||""),idOfferta:u,title:String(t.nome??t.name??t.titolo??t.Titolo??"Prodotto"),description:String(t.descrizione??t.description??""),price:D,priceCents:f,originalPrice:z,originalPriceCents:a,discountPct:l,image:t.LogoLink||"/vite.svg",speseSpedizione:Number(t.SpeseSpedizione??t.speseSpedizione??0),raw:t}}),o=r.useCallback(async()=>{if(!i){n([]);return}d(null),c(!0);try{const e=await b.get("/api/prodotti",{params:{segmento:i,idOperatore:s}}),t=Array.isArray(e.data)?e.data:e.data?.data||[];n(g(t))}catch(e){d(e.normalized||e)}finally{c(!1)}},[i,s]);return r.useEffect(()=>{o()},[o]),{data:m,loading:S,error:P,refetch:o}}export{y as u};
