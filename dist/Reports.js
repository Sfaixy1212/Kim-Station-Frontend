import{r as a,j as e,d as f}from"./vendor.js";import{C as m}from"./Card.js";import{g as x}from"./index.js";import{S as N}from"./Topbar2.js";function D(){const[p,g]=a.useState([]),[u,n]=a.useState(!0),[i,y]=a.useState(null),[t,d]=a.useState({recordsets:[],loading:!1,error:""});a.useEffect(()=>{let r=!0;return(async()=>{try{n(!0);const s=await x("/supermaster/reports");if(!r)return;g(Array.isArray(s?.rows)?s.rows:[])}finally{r&&n(!1)}})(),()=>{r=!1}},[]);const h=async r=>{y(r),d({recordsets:[],loading:!0,error:""});try{const s=await x(`/supermaster/reports/${r}`),l=Array.isArray(s?.recordsets)?s.recordsets:[];d({recordsets:l,loading:!1,error:""})}catch{d({recordsets:[],loading:!1,error:"Errore nel caricamento report"})}},j=r=>{const s=Array.isArray(r)?r:[];if(s.length===0)return e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun dato"});const l=Object.keys(s[0]||{});return e.jsx("div",{className:"overflow-auto border border-gray-200 rounded",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:l.map(o=>e.jsx("th",{className:"px-3 py-2 text-left text-gray-600 border-b",children:o},o))})}),e.jsx("tbody",{children:s.map((o,b)=>e.jsx("tr",{className:"border-b last:border-0",children:l.map(c=>e.jsx("td",{className:"px-3 py-2 text-gray-800 whitespace-nowrap",children:String(o[c])},c))},b))})]})})};return e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{className:"w-full px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Report Center"}),e.jsx(f,{to:"/supermaster",className:"px-3 py-2 text-sm rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Torna a SuperMaster"})]}),e.jsx(m,{title:"Report disponibili",subtitle:"Seleziona un report per vederne l'anteprima",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:u?Array.from({length:6}).map((r,s)=>e.jsx("div",{className:"h-20 bg-gray-100 animate-pulse rounded"},s)):p.map(r=>e.jsxs("button",{onClick:()=>h(r.ID),className:`text-left p-3 border rounded hover:bg-gray-50 ${i===r.ID?"border-indigo-500":"border-gray-200"}`,children:[e.jsx("div",{className:"font-medium text-gray-800 line-clamp-1",children:r.Titolo}),e.jsx("div",{className:"text-xs text-gray-500 line-clamp-2",children:r.Descrizione})]},r.ID))})}),i!=null&&e.jsxs(m,{title:"Anteprima",subtitle:`Report ID: ${i}`,children:[t.loading&&e.jsx("div",{className:"text-sm text-gray-500",children:"Caricamentoâ€¦"}),t.error&&e.jsx("div",{className:"text-sm text-red-600",children:t.error}),!t.loading&&!t.error&&e.jsx("div",{className:"space-y-6",children:t.recordsets.map((r,s)=>e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Recordset ",s+1]}),j(r)]},s))})]})]})]})}export{D as default};
