import{r as h,j as e}from"./vendor.js";import{D as le}from"./DashboardLayout.js";import{g as R,p as G}from"./index.js";import"./logo2.js";function Y(u){const o=String(u||"").toLowerCase();return o.includes("ok")||o.includes("attivo")||o.includes("valido")?"bg-green-100 text-green-800":o.includes("proc")||o.includes("pend")||o.includes("verifica")?"bg-blue-100 text-blue-800":o.includes("scad")||o.includes("rifiut")||o.includes("annull")||o.includes("ko")?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function ie(u){if(!u||typeof u!="object")return null;const o=["ID","Id","id","IDContratto","IdContratto","idContratto","ID_Contratto","id_contratto","IDOrdine","IdOrdine","idOrdine","orderId","ContractId","contractId","CONTRACT_ID","_id","NumeroContratto","numeroContratto","NumContratto"];for(const d of o)if(d in u){const x=u[d];if(x!=null&&x!=="")return x}return null}function Z(u){if(!u)return"";let o=String(u).trim();try{const m=new URL(o);if(m.protocol==="http:"||m.protocol==="https:")return o}catch{}try{const m=typeof window<"u"&&window.location?.origin?window.location.origin:"https://station.kimweb.agency";o=new URL(o,m).pathname||o}catch{}let d=o.replace(/\\/g,"/").replace(/^\/+/,"");return d.startsWith("uploads/")&&(d=d.replace(/^uploads\//,"")),`https://contrattistation.s3.eu-west-1.amazonaws.com/${d.split("/").filter(Boolean).map(m=>{let p=m;try{p=decodeURIComponent(m)}catch{}const g=p.replace(/\s/g,"+");return encodeURIComponent(g).replace(/%2B/g,"+")}).join("/")}`}function Q(u){if(!u)return"-";if(typeof u=="string"){const o=u.trim(),d=o.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/);if(d){const m=d[1],p=d[2],g=d[3];return g==="00"||p==="00"?"-":`${g}/${p}/${m}`}const x=o.match(/^(\d{1,2})[./-](\d{1,2})[./-](\d{4})$/);if(x){const m=parseInt(x[1],10),p=parseInt(x[2],10),g=x[3];return!m||!p?"-":m<=12&&p>12?`${String(p).padStart(2,"0")}/${String(m).padStart(2,"0")}/${g}`:`${String(m).padStart(2,"0")}/${String(p).padStart(2,"0")}/${g}`}}try{const o=new Date(u);if(!isNaN(o.getTime())){const d=String(o.getDate()).padStart(2,"0"),x=String(o.getMonth()+1).padStart(2,"0"),m=o.getFullYear();return`${d}/${x}/${m}`}}catch{}return String(u)}function K(u){if(!u)return"-";if(typeof u=="string"){const d=u.trim().match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/);if(d){const x=d[1],m=d[2],p=d[3],g=d[4],A=d[5];return p==="00"||m==="00"?"-":`${p}/${m}/${x} ${g}:${A}`}}try{const o=new Date(u);if(!isNaN(o.getTime())){const d=String(o.getDate()).padStart(2,"0"),x=String(o.getMonth()+1).padStart(2,"0"),m=o.getFullYear(),p=String(o.getHours()).padStart(2,"0"),g=String(o.getMinutes()).padStart(2,"0");return`${d}/${x}/${m} ${p}:${g}`}}catch{}return Q(u)}function ce(){const[u,o]=h.useState([]),[d,x]=h.useState(!0),[m,p]=h.useState(null),[g,A]=h.useState(""),[de,J]=h.useState({}),[X,M]=h.useState(!1),[_,L]=h.useState(!1),[w,z]=h.useState(null),[s,b]=h.useState(null),[k,U]=h.useState(!1),[O,T]=h.useState(null),[V,j]=h.useState(""),[B,E]=h.useState(""),D=async()=>{x(!0),p(null);try{const t=["/master/contratti","/master/contratti-upload","/master/contratti/tutti"];let a=null,i=null;for(const r of t)try{const n=await R(r),y=Array.isArray(n?.data)?n.data:Array.isArray(n)?n:n?.items||n?.rows||[];if(Array.isArray(y)){a=y;break}}catch(n){i=n}if(!a)throw i||new Error("Nessun endpoint valido per contratti master");const l=[...a.map((r,n)=>{const y=ie(r);if(!y&&typeof window<"u")try{console.log("MasterContractsTable: elemento senza id, chiavi:",Object.keys(r))}catch{}const v=r.DataOra??r.DataUpload??r.Data??r.createdAt??r.data??"-",I=Q(v),H=r.NomeDealer??r.Dealer??r.DealerName??r.nomeDealer??r.dealerName??r.RagioneSocialeDealer??r.DenominazioneDealer??r.nome_dealer??null,ne=H?String(H):r.idDealer!=null&&r.idDealer!==""?`Dealer #${r.idDealer}`:r.Utente||"-",q=r.Cliente??r.NomeCliente??r.cliente??r.nomeCliente??r.RagioneSociale??r.ragioneSociale??null,W=r.CognomeCliente??r.Cognome??r.cognome??null;let F="-";if(W)F=String(W);else if(q){const f=String(q).trim().split(/\s+/);F=f.length>1?f[f.length-1]:f[0]}let C=r.MeseContratto??"-",S=r.AnnoContratto??"-";if((C==="-"||S==="-")&&I&&I!=="-"){const f=new Date(I);if(!isNaN(f)){if(C==="-")try{C=f.toLocaleDateString("it-IT",{month:"long"})}catch{C=String(f.getMonth()+1).padStart(2,"0")}S==="-"&&(S=String(f.getFullYear()))}}const oe=r.Stato??r.status??"-";return{id:y,date:I,dealer:ne,cognome:F,mese:C,anno:S,stato:oe,raw:r}})].sort((r,n)=>{const y=r.raw?.DataOrdinamento?new Date(r.raw.DataOrdinamento):r.date?new Date(r.date):null,v=n.raw?.DataOrdinamento?new Date(n.raw.DataOrdinamento):n.date?new Date(n.date):null;return y&&v&&!isNaN(y)&&!isNaN(v)?v-y:r.id&&n.id?(parseInt(n.id,10)||0)-(parseInt(r.id,10)||0):0});o(l);try{const r=Array.from(new Set(l.map(n=>n?.raw?.idDealer).filter(n=>n!=null&&n!=="")));r.length>0&&await re(r)}catch{}}catch(t){p(t?.message||"Errore di caricamento")}finally{x(!1)}},N=(t,{mode:a="percent",keepUploadsPrefix:i=!0}={})=>{if(!t)return"";let c=String(t).trim();try{const n=new URL(c);if(n.protocol==="http:"||n.protocol==="https:")return c}catch{}try{const n=typeof window<"u"&&window.location?.origin?window.location.origin:"https://station.kimweb.agency";c=new URL(c,n).pathname||c}catch{}let l=c.replace(/\\/g,"/").replace(/^\/+/,"");return!i&&l.startsWith("uploads/")&&(l=l.replace(/^uploads\//,"")),`https://contrattistation.s3.eu-west-1.amazonaws.com/${l.split("/").filter(Boolean).map(n=>{let y=n;try{y=decodeURIComponent(n)}catch{}if(a==="plus"){const v=y.replace(/ /g,"+");return encodeURIComponent(v)}else return encodeURIComponent(y)}).join("/")}`},ee=async t=>{const a=[N(t,{mode:"percent",keepUploadsPrefix:!0}),N(t,{mode:"plus",keepUploadsPrefix:!0}),N(t,{mode:"percent",keepUploadsPrefix:!1}),N(t,{mode:"plus",keepUploadsPrefix:!1})].filter(Boolean);for(const i of a)try{if((await fetch(i,{method:"HEAD"})).ok){window.open(i,"_blank","noopener,noreferrer");return}}catch{}alert("Documento non trovato su S3 (NoSuchKey).")};h.useEffect(()=>{let t=!1;return(async()=>{if(!s){j("");return}const i=s.FullPath||s.DocumentoUrl||s.Url||"";if(!i){j("");return}const c=[N(i,{mode:"percent",keepUploadsPrefix:!0}),N(i,{mode:"plus",keepUploadsPrefix:!0}),N(i,{mode:"percent",keepUploadsPrefix:!1}),N(i,{mode:"plus",keepUploadsPrefix:!1})];for(const l of c)try{if((await fetch(l,{method:"HEAD"})).ok){t||j(l);return}}catch{}t||j("")})(),()=>{t=!0}},[s]);const te=async()=>{if(w)try{await G(`/master/contratti/${w}/accetta`,{}),await D(),b(t=>t&&{...t,Stato:"ACCETTATO"})}catch(t){alert(`Errore durante ACCETTA: ${t?.message||t}`)}},ae=async()=>{if(!w)return;const t=(B||"").trim();if(!t){alert("Inserisci una motivazione/nota prima di rifiutare il contratto.");return}try{await G(`/master/contratti/${w}/rifiuta`,{nota:t}),await D(),b(a=>a&&{...a,Stato:"RIFIUTATO",Note:t}),E("")}catch(a){alert(`Errore durante RIFIUTA: ${a?.message||a}`)}},re=async(t=[])=>{const a=["/master/dealers","/master/dealer-list","/master/dealers/tutti"];let i=null;for(const l of a)try{const r=await R(l),n=Array.isArray(r?.data)?r.data:Array.isArray(r)?r:r?.items||r?.rows||[];if(Array.isArray(n)&&n.length){i=n;break}}catch{}if(!i)return;const c={};for(const l of i){const r=l.idDealer??l.IDDealer??l.IdDealer??l.ID??l.Id??l._id,n=l.RagioneSociale??l.NomeDealer??l.Denominazione??l.DenominazioneDealer??l.Nome??l.nome??null;r!=null&&n&&(c[String(r)]=String(n))}Object.keys(c).length!==0&&(J(l=>({...l,...c})),o(l=>l.map(r=>{const n=r?.raw?.idDealer;return n!=null&&c[String(n)]?{...r,dealer:c[String(n)]}:r})))};h.useEffect(()=>{D()},[]);const se=async(t,a=null)=>{if(!t&&!a)return;const i=t||a?.ID||a?.idContratto||a?.Id||a?.id;z(i),M(!0),setTimeout(()=>L(!0),0),b(null),T(null),U(!0);try{const c=await R(`/master/contratti/${i}`);c&&(c.ID||c.id||c.Id)?b(c):b(a||{})}catch(c){a?b(a):T(c?.message||"Errore di caricamento dettaglio")}finally{U(!1)}},P=()=>{L(!1),setTimeout(()=>M(!1),200),z(null),b(null),T(null),U(!1),j(""),E("")},$=h.useMemo(()=>{const t=g.trim().toLowerCase();return t?u.filter(a=>(a.date+"").toLowerCase().includes(t)||(a.dealer+"").toLowerCase().includes(t)||(a.cognome+"").toLowerCase().includes(t)||(a.mese+"").toLowerCase().includes(t)||(a.anno+"").toLowerCase().includes(t)||(a.stato+"").toLowerCase().includes(t)):u},[g,u]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-end mb-2",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[$.length," record"]})}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",value:g,onChange:t=>A(t.target.value),placeholder:"Cerca...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),d&&e.jsx("div",{className:"space-y-2",children:[...Array(6)].map((t,a)=>e.jsx("div",{className:"h-5 bg-gray-100 rounded animate-pulse"},a))}),!d&&m&&e.jsxs("div",{className:"text-sm text-red-600 flex items-center justify-between",children:[e.jsx("span",{children:m}),e.jsx("button",{onClick:D,className:"ml-3 px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Riprova"})]}),!d&&!m&&e.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:e.jsxs("table",{className:"min-w-[900px] w-full table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"24%"}}),e.jsx("col",{style:{width:"24%"}}),e.jsx("col",{style:{width:"12%"}}),e.jsx("col",{style:{width:"10%"}}),e.jsx("col",{style:{width:"120px"}})]}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Data"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Dealer"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Cognome Cliente"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Mese"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Anno"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Stato"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:$.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-6 text-center text-sm text-gray-500",children:"Nessun risultato"})}):$.map((t,a)=>{const i=!!t.id,c=i?"Apri dettagli contratto":"Dettaglio non disponibile";return e.jsxs("tr",{className:`transition-colors ${i?"hover:bg-gray-50 cursor-pointer":"opacity-70 cursor-not-allowed"}`,title:c,onClick:i?()=>se(t.id,t.raw):void 0,"data-id":i?String(t.id):"",children:[e.jsx("td",{className:"py-2 px-2 text-sm text-gray-900 whitespace-nowrap",children:t.date}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-700 truncate",title:t.dealer,children:t.dealer}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-900 truncate",title:t.cognome,children:t.cognome}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-700 whitespace-nowrap",children:t.mese}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-700 whitespace-nowrap",children:t.anno}),e.jsx("td",{className:"py-2 px-2 text-sm text-right whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Y(t.stato)}`,children:t.stato})})]},(t.id??a)+"")})})]})}),X&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:`absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-200 ${_?"opacity-100":"opacity-0"}`,onClick:P}),e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 transition-all duration-200 ease-out transform ${_?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-1"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[e.jsxs("h4",{className:"text-base font-semibold text-gray-900",children:["Dettaglio Contratto",w?` #${w}`:""]}),e.jsx("button",{onClick:P,className:"text-gray-500 hover:text-gray-700","aria-label":"Chiudi",children:"✕"})]}),e.jsxs("div",{className:"p-4 max-h-[70vh] overflow-auto",children:[k&&e.jsx("div",{className:"space-y-2",children:[...Array(4)].map((t,a)=>e.jsx("div",{className:"h-4 bg-gray-100 rounded animate-pulse"},a))}),O&&!k&&e.jsx("div",{className:"text-sm text-red-600",children:O}),!k&&!O&&s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Dettagli contratto (DB)"}),(()=>{const t=[{key:"ID",label:"ID",value:s.ID??s.Id??s.id??s.idContratto},{key:"idDealer",label:"idDealer",value:s.idDealer??s.IDDealer},{key:"DataOra",label:"DataOra",value:K(s.DataOra??s.DataUpload??s.Data)},{key:"NomeFile",label:"NomeFile",value:s.NomeFile??s.FileName},{key:"FileUID",label:"FileUID",value:s.FileUID??s.fileUid},{key:"CognomeCliente",label:"CognomeCliente",value:s.CognomeCliente??s.Cognome},{key:"CodiceProposta",label:"CodiceProposta",value:s.CodiceProposta??s.Codice??s.CodiceOfferta},{key:"FullPath",label:"FullPath",value:s.FullPath??s.DocumentoUrl??s.Url},{key:"Utente",label:"Utente",value:s.Utente??s.User},{key:"MeseContratto",label:"MeseContratto",value:s.MeseContratto??s.Mese},{key:"AnnoContratto",label:"AnnoContratto",value:s.AnnoContratto??s.Anno},{key:"Stato",label:"Stato",value:s.Stato??s.status},{key:"Note",label:"Note",value:s.Note??s.note}].filter(a=>a.value!==null&&a.value!==void 0&&String(a.value).trim()!=="");return t.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun dettaglio disponibile"}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.map((a,i)=>e.jsxs("div",{className:a.key==="FullPath"?"sm:col-span-2":"",children:[e.jsx("div",{className:"text-xs text-gray-500",children:a.label}),a.key==="Stato"?e.jsx("div",{className:`inline-block mt-0.5 px-2 py-0.5 rounded-full text-xs ${Y(a.value)}`,children:a.value}):a.key==="FullPath"&&typeof a.value=="string"&&a.value?e.jsx("button",{type:"button",onClick:()=>{try{const c=s.DocumentoUrl||s.FullPath||s.Url||a.value,r=(c?Z(c):"")||V||"";if(r){window.open(r,"_blank","noopener,noreferrer");return}}catch{}ee(a.value)},className:"inline-flex items-center text-xs font-medium px-2 py-1 rounded bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:"APRI FILE"}):e.jsx("div",{className:"text-sm text-gray-900 break-words",children:String(a.value)})]},i))})})()]}),(()=>{const t=V;if(!t)return null;const a=/\.pdf($|\?)/i.test(t);return e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Anteprima documento"}),a?e.jsx("div",{className:"border border-gray-200 rounded overflow-hidden bg-gray-50",children:e.jsx("iframe",{src:t,title:"Anteprima documento",className:"w-full h-[520px] bg-white"})}):e.jsx("div",{className:"text-sm text-gray-500",children:'Anteprima non disponibile per questo formato. Usa "APRI FILE" per visualizzare.'})]})})(),(s.Intestatario||s.PayloadIntestario||s.Payload)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Intestatario"}),(()=>{const t=s.Intestatario||{},a={...s.Payload||{},...s.PayloadIntestario||{}},i=t.RagioneSociale||[t.Nome,t.Cognome].filter(Boolean).join(" ").trim()||(a.NOME_E_COGNOME_INTESTATARIO_CONTRATTO||"").trim()||[a.NOME,a.COGNOME].filter(Boolean).join(" ").trim(),c=t.CodiceFiscale||a.CODICE_FISCALE_INTESTATARIO||a.CodiceFiscale||a.CODICE_FISCALE||a.CF,l=[{label:"Nome e Cognome / Ragione sociale",value:i},{label:"Codice Fiscale",value:c},{label:"Data di nascita",value:t.DataNascita||a.DATA_DI_NASCITA},{label:"Luogo di nascita",value:t.LuogoNascita||a.LUOGO_DI_NASCITA},{label:"Indirizzo",value:t.Indirizzo||a.INDIRIZZO_E_CIVICO_ATTIVAZIONE},{label:"CAP",value:t.CAP||a.CAP},{label:"Città",value:t.Citta||a.CITTA},{label:"Provincia",value:t.Provincia||a.PROVINCIA},{label:"P.IVA",value:t.PIVA||a.PARTITA_IVA},{label:"Email",value:t.Email||a.EMAIL},{label:"Telefono",value:t.Telefono||a.TELEFONO||a.RECAPITO_DI_RIFERIMENTO}].filter(r=>{const n=r.value;return n&&n!==""&&n!=="-"&&n!==null&&n!==void 0&&String(n).trim()!==""});return l.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:l.map((r,n)=>e.jsxs("div",{className:r.label.startsWith("Indirizzo")?"sm:col-span-2":"",children:[e.jsx("div",{className:"text-xs text-gray-500",children:r.label}),e.jsx("div",{className:"text-gray-800 break-words",children:r.value})]},n))}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun dato intestatario disponibile"})})()]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:["Documenti ",s.Documenti?.length?`(${s.Documenti.length})`:""]}),(()=>{const t=s.DocumentoUrl||s.FullPath||s.Url||"",a=t?Z(t):"",i=Array.isArray(s.Documenti)?s.Documenti:[],l=i.length>0?i:a?[{tipo:"Contratto",nomeOriginale:s.NomeFile||"Documento contratto",url:a}]:[];return l.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun documento allegato"}):e.jsx("div",{className:"space-y-2",children:l.map((r,n)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-700 font-medium",children:r.tipo||r.nome||"Documento"}),e.jsx("div",{className:"text-xs text-gray-500",children:r.nomeOriginale||r.filename||s.NomeFile||""})]}),r.url?e.jsx("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 rounded bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:"Visualizza"}):e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600",children:"Non disponibile"})]},n))})})()]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Storico"}),Array.isArray(s.Storico)&&s.Storico.length>0?e.jsx("div",{className:"border border-gray-100 rounded",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-600",children:[e.jsx("th",{className:"text-left px-2 py-1",children:"Data"}),e.jsx("th",{className:"text-left px-2 py-1",children:"Utente"}),e.jsx("th",{className:"text-left px-2 py-1",children:"Da"}),e.jsx("th",{className:"text-left px-2 py-1",children:"A"}),e.jsx("th",{className:"text-left px-2 py-1",children:"Nota"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.Storico.map((t,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:K(t.DataOra)}),e.jsx("td",{className:"px-2 py-1",children:t.Utente}),e.jsx("td",{className:"px-2 py-1",children:t.StatoPrecedenteNome||t.StatoPrecedente}),e.jsx("td",{className:"px-2 py-1",children:t.StatoNuovoNome||t.StatoNuovo}),e.jsx("td",{className:"px-2 py-1",children:t.Nota})]},a))})]})}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nessuno storico disponibile"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Nota per il dealer (obbligatoria per rifiutare)"}),e.jsx("textarea",{value:B,onChange:t=>E(t.target.value),rows:3,className:"w-full text-sm border border-gray-200 rounded-md px-2 py-1.5 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-none",placeholder:"Inserisci la motivazione del rifiuto. Sarà inviata al dealer e salvata nello storico."})]})]})]}),e.jsxs("div",{className:"p-3 border-t border-gray-100 flex justify-end gap-2",children:[e.jsx("button",{onClick:te,className:"px-3 py-1.5 text-sm rounded bg-emerald-600 hover:bg-emerald-700 text-white",title:"Accetta il contratto (stato 10)",children:"ACCETTA"}),e.jsx("button",{onClick:ae,className:"px-3 py-1.5 text-sm rounded bg-red-600 hover:bg-red-700 text-white",title:"Rifiuta il contratto (stato 11) e invia email",children:"RIFIUTA"}),e.jsx("button",{onClick:P,className:"px-3 py-1.5 text-sm rounded bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Chiudi"})]})]})]})]})}function he(){return e.jsx(le,{title:"Contratti",children:e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"rounded-2xl bg-white p-8 sm:p-6 shadow-sm h-[calc(100vh-150px)] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Contratti"})}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx("div",{className:"h-full overflow-auto pr-1",children:e.jsx(ce,{})})})]})})})}export{he as default};
