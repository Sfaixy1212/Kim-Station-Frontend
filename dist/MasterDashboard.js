import{r as u,j as e}from"./vendor.js";import{D as Ve}from"./DashboardLayout.js";import{g as he,p as fe,a as Qe}from"./index.js";import"./logo2.js";function Ie(N){if(!N)return"-";if(typeof N=="string"){const g=N.trim(),p=g.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/);if(p){const x=p[1],h=p[2],m=p[3];return m==="00"||h==="00"?"-":`${m}/${h}/${x}`}const y=g.match(/^(\d{1,2})[./-](\d{1,2})[./-](\d{4})$/);if(y){const x=parseInt(y[1],10),h=parseInt(y[2],10),m=y[3];return!x||!h?"-":`${String(x).padStart(2,"0")}/${String(h).padStart(2,"0")}/${m}`}}try{const g=new Date(N);if(!isNaN(g.getTime())){const p=String(g.getDate()).padStart(2,"0"),y=String(g.getMonth()+1).padStart(2,"0"),x=g.getFullYear();return`${p}/${y}/${x}`}}catch{}return String(N)}function Ae(N){const g=(N||"").toString(),p=g.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").trim().toUpperCase().replace(/\s+/g,"_"),y=new Set(["ATTIVATO","SIM_SOSTITUITA","RESET_ESEGUITO","RILANCIO_ESEGUITO","TICKET_GESTITO_CON_NOTA","ORDINE_SBLOCCATO","SUBENTRO_EFFETTUATO","PRENOTATO","CLIENTE_ACQUISIBILE"]),x=new Set(["CLIENTE_NON_ACQUISIBILE"]),h=new Set(["TICKET_APERTO","TICKET_IN_LAVORAZIONE"]);if(y.has(p))return"bg-green-100 text-green-800";if(x.has(p))return"bg-red-100 text-red-800";if(h.has(p))return"bg-yellow-100 text-yellow-800";const m=g.toLowerCase();return m.includes("attiv")||m.includes("success")||m.includes("ok")?"bg-green-100 text-green-800":m.includes("lavor")||m.includes("pend")||m.includes("proc")||m.includes("da_")?"bg-blue-100 text-blue-800":m.includes("rifiut")||m.includes("ko")||m.includes("err")||m.includes("annull")?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}function He(N,g=3){const p=["url","URL","FullPath","fullPath","Url","path","Path","Link","link","Href","href","Percorso"],y=["TipoFile","tipo","FileUID","fileUID","NomeFile","name","filename"];function x(m){if(!Array.isArray(m)||!m.length)return!1;const O=m[0];if(!O||typeof O!="object")return!1;const R=p.some(E=>E in O&&typeof O[E]=="string"),w=y.some(E=>E in O);return R||w}function h(m,O){if(!m||typeof m!="object"||O>g)return null;if(Array.isArray(m)&&x(m))return m;const R=Object.keys(m);for(const w of R){const E=m[w];if(Array.isArray(E)&&x(E))return E}for(const w of R){const E=m[w];if(E&&typeof E=="object"){const _=h(E,O+1);if(_)return _}}return null}return h(N,0)}function Ee({nomeFile:N,dataOrdine:g}){if(!N)return"";let p="",y="";if(g)try{const m=new Date(g);isNaN(m.getTime())||(p=String(m.getFullYear()),y=String(m.getMonth()+1).padStart(2,"0"))}catch{}const x=["contratti"];return p&&x.push(p),y&&x.push(y),`https://attivazionistation.s3.eu-west-1.amazonaws.com/${`${x.join("/")}/${N}`}`}function Ye(N){if(!N)return"-";if(typeof N=="string"){const g=N.trim(),p=g.match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/);if(p){const x=p[1],h=p[2],m=p[3];return m==="00"||h==="00"?"-":`${m}/${h}/${x}`}const y=g.match(/^(\d{1,2})[./-](\d{1,2})[./-](\d{4})$/);if(y){const x=parseInt(y[1],10),h=parseInt(y[2],10),m=y[3];if(!x||!h)return"-";if(x<=12&&h>12){const w=String(h).padStart(2,"0"),E=String(x).padStart(2,"0");return`${w}/${E}/${m}`}const O=String(x).padStart(2,"0"),R=String(h).padStart(2,"0");return`${O}/${R}/${m}`}}try{const g=new Date(N);if(!isNaN(g.getTime())){const p=String(g.getDate()).padStart(2,"0"),y=String(g.getMonth()+1).padStart(2,"0"),x=g.getFullYear();return`${p}/${y}/${x}`}}catch{}return String(N)}function We(N){if(!N)return"-";if(typeof N=="string"){const p=N.trim().match(/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/);if(p){const y=p[1],x=p[2],h=p[3],m=p[4],O=p[5];return h==="00"||x==="00"?"-":`${h}/${x}/${y} ${m}:${O}`}}try{const g=new Date(N);if(!isNaN(g.getTime())){const p=String(g.getDate()).padStart(2,"0"),y=String(g.getMonth()+1).padStart(2,"0"),x=g.getFullYear(),h=String(g.getHours()).padStart(2,"0"),m=String(g.getMinutes()).padStart(2,"0");return`${p}/${y}/${x} ${h}:${m}`}}catch{}return Ye(N)}function P(N){if(!N)return"";const g=String(N).trim();try{if(new URL(g).hostname.includes("attivazionistation.s3"))return g}catch{}let p=g;try{const y=typeof window<"u"&&window.location?.origin?window.location.origin:"https://station.kimweb.agency";p=new URL(p,y).pathname||p}catch{}return p.startsWith("/uploads/")&&(p=p.replace(/^\/uploads\//,"")),p=p.replace(/^\/+/,""),`https://attivazionistation.s3.eu-west-1.amazonaws.com/${p}`}function Je(){const[N,g]=u.useState([]),[p,y]=u.useState(!0),[x,h]=u.useState(null),[m,O]=u.useState(""),[R,w]=u.useState(!1),[E,_]=u.useState(!1),[C,ne]=u.useState(null),[a,Q]=u.useState(null),[H,Y]=u.useState(!1),[W,J]=u.useState(null),[Se,de]=u.useState(null),[M,X]=u.useState(""),[v,ee]=u.useState(""),[r,G]=u.useState(!1),[ce,D]=u.useState(""),[te,L]=u.useState(null),[me,pe]=u.useState(!1),[ue,U]=u.useState(""),[$,z]=u.useState(!1),[ge,q]=u.useState(""),[be,Z]=u.useState(!1),[ae,xe]=u.useState({message:"",type:"success"}),k=(t,i="success")=>{try{xe({message:t,type:i})}catch{}try{clearTimeout(k._t)}catch{}k._t=setTimeout(()=>xe({message:"",type:i}),3e3)},re=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="CERTIFICAZIONE_INDIRIZZO"}catch{return!1}},[a]),Oe=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="RESET_CREDENZIALI_DEALER_FASTWEB"}catch{return!1}},[a]),Ce=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="TICKET_CLIENTE_NON_ACQUISIBILE"}catch{return!1}},[a]),je=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="RILANCIO_MNP_FASTWEB"}catch{return!1}},[a]),Ne=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="RICONTATTO_CLIENTE"}catch{return!1}},[a]),ve=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="NON_ACQUISIBILE"}catch{return!1}},[a]),we=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="MOBILE_CONSUMER_RESET_CREDENZIALI"}catch{return!1}},[a]),Re=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="SOSTITUZIONE_GUASTO_O_CAMBIO_FORMATO"}catch{return!1}},[a]),ye=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="FURTO_SMARRIMENTO"}catch{return!1}},[a]),De=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="SUBENTRO_1MOBILE"}catch{return!1}},[a]),Ue=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="TICKET_ORDINE_FISSO_PARCHEGGIATO"}catch{return!1}},[a]),Fe=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="SKY_MOBILE_PORTABILITA"}catch{return!1}},[a]),ke=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="SKY_MOBILE_NUOVO_NUMERO"}catch{return!1}},[a]),Le=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="SKY_WIFI_3P_4P"}catch{return!1}},[a]),Pe=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="ONLY_TV"}catch{return!1}},[a]),_e=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="INFO_PRATICA"}catch{return!1}},[a]),Me=u.useMemo(()=>{try{const t=a?.IDOperatore||a?.idOperatore||a?.IdOperatore||a?.Offerta?.idOperatore||a?.Offerta?.IDOperatore;return console.log("[ENI DEBUG] idOperatore:",t,"isEni:",t===16||t==="16","detail:",a),t===16||t==="16"}catch{return!1}},[a]),$e=u.useMemo(()=>{try{const t=o=>(o||"").toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase().replace(/\s+/g,"_");return(t(a?.TemplateCodice)||t(a?.Template?.template||a?.Template))==="TICKET_INFO_PRATICA"}catch{return!1}},[a]),K=async()=>{y(!0),h(null);try{const t=["/master/attivazioni","/master/ultime-attivazioni"];let i=null,o=null;for(const s of t)try{const T=await he(s),I=Array.isArray(T?.data)?T.data:Array.isArray(T)?T:T?.items||T?.rows||[];if(Array.isArray(I)&&I.length>=0){i=I;break}}catch(T){o=T}if(!i)throw o||new Error("Nessun endpoint valido per attivazioni master");const d=/^(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2}):(\d{2})(?:\.\d+)?$/,n=s=>{const T=[s.DataOra,s.DataOrdinamento,s.DataOrdine,s.Data,s.date,s.createdAt,s.data].filter(f=>f!=null&&f!==""),I=T.find(f=>typeof f=="string"&&d.test(f.trim()));if(I)return I;const A=T.find(f=>typeof f=="string"&&/(\d{1,2})[./-](\d{1,2})[./-](\d{4})/.test(String(f).trim()));return A||T[0]||"-"},b=[...i.map(s=>{const T=s.IDOrdine??s.id??s.orderId??s.ID??null,I=n(s),A=Ie(I),f=s.Offerta??s.TitoloOfferta??s.Titolo??s.title??s.Valore??"-",Te=s.Dealer??s.NomeDealer??s.dealer??s.nomeDealer??s.RagioneSociale??"-",V=s.Cliente??s.NomeCliente??s.cliente??s.nomeCliente??s.Intestatario??"-",j=s.Stato??s.StatoEsteso??s.status??"-";return{id:T,date:A,offerta:f,dealer:Te,cliente:V,stato:j,raw:s}})].sort((s,T)=>{const I=s.raw?.DataOrdinamento?new Date(s.raw.DataOrdinamento):s.date?new Date(s.date):null,A=T.raw?.DataOrdinamento?new Date(T.raw.DataOrdinamento):T.date?new Date(T.date):null;return I&&A&&!isNaN(I)&&!isNaN(A)?A-I:s.id&&T.id?(parseInt(T.id,10)||0)-(parseInt(s.id,10)||0):0});g(b)}catch(t){h(t?.message||"Errore di caricamento")}finally{y(!1)}},l=async({targetState:t,emailTemplateId:i,requireNote:o=!1})=>{if(C){if(D(""),o&&!v.trim()){D("La nota è obbligatoria per questa azione.");return}G(!0);try{const n=(c=>{if(c==null)return 0;if(typeof c=="string"){const b=c.trim();if(b==="")return 0;const s=parseInt(b,10);return Number.isFinite(s)?s:b}return typeof c=="number"&&!Number.isFinite(c)?0:c})(t);await fe(`/master/attivazione/${C}/stato`,{stato:n,nota:v.trim()||void 0,emailTemplateId:i||void 0}),await B(C),await K(),k("Stato aggiornato con successo")}catch(d){D(d?.message||"Errore durante il cambio stato")}finally{G(!1)}}};u.useEffect(()=>{K()},[]);const B=async t=>{if(t){ne(t),w(!0),setTimeout(()=>_(!0),0),Q(null),J(null),Y(!0),X("");try{const i=await he(`/master/attivazione/${t}`);Q(i),ee(""),D(""),L(null),U("");let o=i?.Documenti||i?.FileOrdine||i?.tbFileOrdine||i?.DocumentiOrdine;if(!Array.isArray(o)){const d=Object.keys(i||{}).filter(n=>Array.isArray(i[n]));for(const n of d){const c=i[n];if(c&&c.length&&typeof c[0]=="object"){const b=c[0]||{};if(["url","URL","FullPath","fullPath","Url","path","Path","Link","link","Href","href","Percorso"].some(A=>A in b&&typeof b[A]=="string"&&/^(https?:\/\/|\/)/i.test(b[A]))||["TipoFile","tipo","FileUID","fileUID","NomeFile","name","filename"].some(A=>A in b)){o=c;break}}}if(!Array.isArray(o))try{const n=He(i,3);Array.isArray(n)&&(o=n)}catch{}}if(Array.isArray(o)&&o.length>0){de(o);try{const d=o.map(s=>{const T=s?.Payload?.s3Url||s?.payload?.s3Url||"";if(T)return P(T);const I=s?.Payload?.s3Key||s?.payload?.s3Key||"";if(I)return P(`https://attivazionistation.s3.eu-west-1.amazonaws.com/${I}`);const A=s.url||s.URL||s.FullPath||s.fullPath||s.Url||s.path||s.Path||s.Link||s.link||s.Href||s.href||s.Percorso||"";if(A)return P(A);const f=s.NomeFile||s.nome||s.filename||"";return Ee({nomeFile:f,dataOrdine:i?.DataOrdine})}),n=d.find(s=>/\.pdf($|\?)/i.test(s)),c=d.find(s=>/\.(png|jpe?g|gif|webp)($|\?)/i.test(s)),b=n||c||"";b&&X(b)}catch{}}else de([])}catch(i){J(i?.message||"Errore di caricamento dettaglio")}finally{Y(!1)}}},ie=()=>{_(!1),setTimeout(()=>w(!1),200),ne(null),Q(null),J(null),Y(!1),ee(""),D(""),L(null),U("")},F=async t=>{if(C){if(D(""),t===3&&!v.trim()){D("La nota è obbligatoria per questo stato.");return}G(!0);try{const o=(d=>{if(d==null)return 0;if(typeof d=="string"){const n=d.trim();if(n==="")return 0;const c=parseInt(n,10);return Number.isFinite(c)?c:n}return typeof d=="number"&&!Number.isFinite(d)?0:d})(t);await fe(`/master/attivazione/${C}/stato`,{stato:o,nota:v.trim()||void 0}),await B(C),await K(),k("Stato aggiornato con successo")}catch(i){D(i?.message||"Errore durante il cambio stato")}finally{G(!1)}}},Ge=t=>{if(U(""),!t){L(null);return}if(!["application/pdf","image/jpeg","image/jpg","image/png","image/webp"].includes(t.type)){U("Sono consentiti solo PDF e immagini (JPG, PNG, WEBP)."),L(null);return}if(t.size>10*1024*1024){U("Dimensione massima 10MB."),L(null);return}L(t)},ze=async()=>{if(C){if(U(""),!te){U("Seleziona un file PDF prima di caricare.");return}pe(!0);try{const t=new FormData;t.append("file",te),await Qe(`/master/attivazione/${C}/upload-pda`,t),await B(C)}catch(t){U(t?.message||"Errore durante l'upload del PDA")}finally{pe(!1)}}},se=u.useMemo(()=>{const t=m.trim().toLowerCase();return t?N.filter(i=>(i.id+"").toLowerCase().includes(t)||(i.date+"").toLowerCase().includes(t)||(i.offerta+"").toLowerCase().includes(t)||(i.dealer+"").toLowerCase().includes(t)||(i.cliente+"").toLowerCase().includes(t)||(i.stato+"").toLowerCase().includes(t)):N},[m,N]);return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-end mb-2",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[se.length," record"]})}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",value:m,onChange:t=>O(t.target.value),placeholder:"Cerca...",className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),p&&e.jsx("div",{className:"space-y-2",children:[...Array(6)].map((t,i)=>e.jsx("div",{className:"h-5 bg-gray-100 rounded animate-pulse"},i))}),!p&&x&&e.jsxs("div",{className:"text-sm text-red-600 flex items-center justify-between",children:[e.jsx("span",{children:x}),e.jsx("button",{onClick:K,className:"ml-3 px-2 py-1 rounded bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Riprova"})]}),!p&&!x&&e.jsx("div",{className:"overflow-x-auto -mx-2 sm:mx-0",children:e.jsxs("table",{className:"min-w-[920px] w-full table-fixed",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"16%"}}),e.jsx("col",{style:{width:"12%"}}),e.jsx("col",{style:{width:"36%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"120px"}})]}),e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Data Ordine"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"ID Ordine"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Offerta"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Dealer"}),e.jsx("th",{className:"text-left py-2 px-2 text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Stato"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:se.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"py-6 text-center text-sm text-gray-500",children:"Nessun risultato"})}):se.map((t,i)=>e.jsxs("tr",{className:`transition-colors ${t.id?"hover:bg-gray-50 cursor-pointer":"opacity-70 cursor-not-allowed"}`,onClick:()=>t.id&&B(t.id),title:t.id?"Apri dettagli attivazione":"Dettaglio non disponibile",children:[e.jsx("td",{className:"py-2 px-2 text-sm text-gray-900 whitespace-nowrap",children:t.date}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-700 whitespace-nowrap",children:t.id??"-"}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-900 truncate",title:t.offerta,children:t.offerta}),e.jsx("td",{className:"py-2 px-2 text-sm text-gray-700 truncate",title:t.dealer,children:t.dealer}),e.jsx("td",{className:"py-2 px-2 text-sm text-right whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${Ae(t.stato)}`,children:t.stato})})]},(t.id??i)+""))})]})}),R&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:`absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-200 ${E?"opacity-100":"opacity-0"}`,onClick:ie}),e.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl w-full max-w-3xl mx-4 transition-all duration-200 ease-out transform ${E?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-1"}`,children:[ae.message&&e.jsx("div",{className:"absolute right-3 top-3 z-10",children:e.jsx("div",{className:`px-3 py-2 text-xs rounded shadow ${ae.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-red-50 text-red-800 border border-red-200"}`,children:ae.message})}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900",children:(()=>{const t=(a?.TitoloOfferta||a?.Offerta||"").toString().trim(),i=a?.Payload||a?.payload||a?.Dati||{},o=(a?.Operatore||a?.OPERATORE||i?.OPERATORE||i?.operatore||"").toString().trim(),d=C?` #${C}`:"",n=t?` - ${t}`:"",c=o?` (${o})`:"";return`Dettaglio Attivazione${d}${n}${c}`})()}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",title:!v||!v.trim()?"Aggiungi una nota: è obbligatoria per ANNULLARE (stato 2)":"Imposta stato ANNULLATO (2) e invia l'email al Dealer. Nota obbligatoria.",onClick:async()=>{if(!(!C||$)){if(q(""),be){z(!0);try{await l({targetState:2,emailTemplateId:void 0,requireNote:!0}),Z(!1),k("Ordine annullato (stato 2) e email inviata")}catch(t){q(t?.message||"Errore durante annullamento")}finally{z(!1)}return}Z(!0),k("Conferma annullamento: premi di nuovo o clicca su Conferma");try{console.log("[MASTER][UI] Annulla ordine armato per ID",C)}catch{}}},className:"px-3 py-1.5 text-xs rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",disabled:$||!v||!v.trim(),children:$?"Annullo...":"ANNULLA ORDINE"}),be&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:async()=>{if(!(!C||$)){q(""),z(!0);try{await l({targetState:2,emailTemplateId:void 0,requireNote:!0}),Z(!1),k("Ordine annullato (stato 2) e email inviata")}catch(t){q(t?.message||"Errore durante annullamento")}finally{z(!1)}}},className:"px-2 py-1 text-xs rounded bg-red-100 text-red-700 hover:bg-red-200 disabled:opacity-60",disabled:$,children:"Conferma"}),e.jsx("button",{type:"button",onClick:()=>Z(!1),className:"px-2 py-1 text-xs rounded bg-gray-100 text-gray-700 hover:bg-gray-200",children:"Annulla"})]})]})}),ge&&e.jsx("div",{className:"mt-2 text-xs text-red-600",children:ge}),e.jsx("button",{onClick:ie,className:"text-gray-500 hover:text-gray-700","aria-label":"Chiudi",children:"✕"})]}),e.jsxs("div",{className:"p-4 max-h-[70vh] overflow-auto",children:[H&&e.jsx("div",{className:"space-y-2",children:[...Array(4)].map((t,i)=>e.jsx("div",{className:"h-4 bg-gray-100 rounded animate-pulse"},i))}),W&&!H&&e.jsx("div",{className:"text-sm text-red-600",children:W}),!H&&!W&&a&&e.jsxs("div",{className:"space-y-4",children:[(()=>{const t=b=>{try{return typeof b=="string"?JSON.parse(b):b||{}}catch{return b||{}}},i=t(a?.Payload),o=t(a?.PayloadIntestario),d=t(a?.Dati),c=((...b)=>b.find(s=>s!=null&&String(s).trim()!==""))(a?.NomeDealer,a?.Dealer,a?.RagioneSociale,a?.ragioneSociale,a?.NomePoint,a?.Point,i?.RAGIONE_SOCIALE_DEALER,i?.DEALER,i?.POINT,o?.RAGIONE_SOCIALE_DEALER,d?.RAGIONE_SOCIALE_DEALER);try{a.__DealerResolved=c?String(c).toUpperCase():""}catch{}return null})(),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[{label:"Data ordine",value:Ie(a.DataOrdine||a.DataOra)},{label:"Stato",value:a.StatoEsteso,isStatus:!0},{label:"Offerta",value:a.TitoloOfferta},{label:"POINT",value:a.__DealerResolved||a.NomeDealer}].filter(t=>t.value&&t.value!=="-").map((t,i)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:t.label}),t.isStatus?e.jsx("div",{className:`inline-block mt-0.5 px-2 py-0.5 rounded-full text-xs ${Ae(t.value)} uppercase`,children:t.value}):e.jsx("div",{className:"text-sm text-gray-900 uppercase",children:t.value})]},i))}),(a.Intestatario||a.PayloadIntestario||a.Payload)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Intestatario"}),(()=>{const t=a.Intestatario||{},i=a?.Payload??a?.payload??{},o=a?.PayloadIntestario??a?.payloadIntestario??{},d=a?.Dati??a?.dati??{};let n={},c={},b={};try{n=typeof i=="string"?JSON.parse(i):i||{}}catch{n=i||{}}try{c=typeof o=="string"?JSON.parse(o):o||{}}catch{c=o||{}}try{b=typeof d=="string"?JSON.parse(d):d||{}}catch{b=d||{}}const s=c&&typeof c.Payload=="object"?c.Payload:{},T=Object.keys(s).length?s:c,I=Object.entries(T||{}).filter(([,j])=>j!=null&&String(j).trim()!=="");if(I.length>0)return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:I.map(([j,S],qe)=>{let oe=String(S);if(j.toUpperCase().includes("NASCITA")&&typeof S=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(S.trim())){const[Ze,Ke,Be]=S.trim().split("-");oe=`${Be}/${Ke}/${Ze}`}const le=j.toUpperCase();return(le.includes("TELEFONO")||le.includes("RECAPITO")||le.includes("NUMERO"))&&typeof S=="string"&&(oe=String(S).replace(/\s+/g,"")),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:j}),e.jsx("div",{className:"text-gray-800 break-words uppercase",children:oe})]},qe)})});const A=n&&typeof n.Payload=="object"?n.Payload:{},f={...n,...b,...A},V=[{label:"Nome e Cognome / Ragione sociale",value:t.RagioneSociale||[t.Nome,t.Cognome].filter(Boolean).join(" ").trim()||(f.NOME_E_COGNOME_INTESTATARIO_CONTRATTO||"").trim()||[f.NOME,f.COGNOME].filter(Boolean).join(" ").trim()},{label:"Codice Fiscale",value:t.CodiceFiscale||f.CODICE_FISCALE_INTESTATARIO||f.CODICE_FISCALE_NUOVO_INTESTATARIO||f.CF||f.CODICE_FISCALE||f.CodiceFiscale},{label:"Recapito di riferimento",value:t.Telefono||f.TELEFONO||f.NUMERO_TELEFONO||f.RECAPITO_DI_RIFERIMENTO}].filter(j=>{const S=j.value;return S&&S!==""&&S!=="-"&&S!==null&&S!==void 0&&String(S).trim()!==""});return V.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:V.map((j,S)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:j.label}),e.jsx("div",{className:"text-gray-800 break-words uppercase",children:j.value})]},S))}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun dato intestatario disponibile"})})()]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:["Dati Attivazione ",a.Template?.template?`(${a.Template.template})`:""]}),a.Template?.campi?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:a.Template.campi.map((t,i)=>{const o={...a.Payload||{}};let d=o[t.key];if(d===void 0){const n=Object.keys(o).find(c=>c.toLowerCase()===String(t.key).toLowerCase());n&&(d=o[n])}if(t.tipo==="date"&&d)try{if(typeof d=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(d.trim())){const[n,c,b]=d.trim().split("-");d=`${b}/${c}/${n}`}else{const n=new Date(d);if(!isNaN(n.getTime())){const c=String(n.getDate()).padStart(2,"0"),b=String(n.getMonth()+1).padStart(2,"0"),s=n.getFullYear();d=`${c}/${b}/${s}`}}}catch{}return{campo:t,valore:d,index:i}}).filter(t=>t.valore&&t.valore!==""&&t.valore!=="-").map(({campo:t,valore:i,index:o})=>{let d=i;const n=(t.key||"").toUpperCase(),c=(t.label||"").toUpperCase();return(n.includes("TELEFONO")||n.includes("RECAPITO")||n.includes("NUMERO")||c.includes("TELEFONO")||c.includes("RECAPITO")||c.includes("NUMERO"))&&typeof i=="string"&&(d=String(i).replace(/\s+/g,"")),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:t.label}),e.jsx("div",{className:"text-gray-800 break-words uppercase",children:d})]},o)})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:Object.entries(a.Payload||{}).filter(([t,i])=>i!=null&&String(i).trim()!=="").map(([t,i],o)=>{let d=String(i);if(t.toUpperCase().includes("NASCITA")&&typeof i=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(i.trim())){const[c,b,s]=i.trim().split("-");d=`${s}/${b}/${c}`}const n=t.toUpperCase();return(n.includes("TELEFONO")||n.includes("RECAPITO")||n.includes("NUMERO"))&&typeof i=="string"&&(d=String(i).replace(/\s+/g,"")),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500",children:t.replaceAll("_"," ")}),e.jsx("div",{className:"text-gray-800 break-words uppercase",children:d})]},o)})})]}),e.jsx("div",{children:(()=>{const t=a?.Documenti&&a.Documenti.length>0?a.Documenti:Se||[];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:["Documenti ",t?.length?`(${t.length})`:""]}),t&&t.length>0?e.jsx("div",{className:"space-y-2",children:t.map((i,o)=>{const d=i.tipo||i.TipoFile||"documento",n=i?.Payload?.s3Url||i?.payload?.s3Url||"",c=i?.Payload?.s3Key||i?.payload?.s3Key||"",b=i.url||i.URL||i.FullPath||i.fullPath||i.Url||i.path||i.Path||i.Link||i.link||i.Href||i.href||i.Percorso||"";let s="";if(n)s=P(n);else if(c)s=P(`https://attivazionistation.s3.eu-west-1.amazonaws.com/${c}`);else if(b)s=P(b);else{const T=i.NomeFile||i.nome||i.filename||"";s=Ee({nomeFile:T,dataOrdine:a?.DataOrdine})}return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"text-sm text-gray-700 font-medium",children:d})}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx("button",{type:"button",onClick:()=>X(s),className:"text-xs px-2 py-1 rounded bg-amber-100 text-amber-800 hover:bg-amber-200 transition-colors",title:"Mostra anteprima",children:"Anteprima"}),s?e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 rounded bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:"APRI FILE"}):e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600",children:"Non disponibile"})]})]},o)})}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nessun documento allegato"})]})})()}),M&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Anteprima documento"}),e.jsx("div",{className:"border border-gray-200 rounded overflow-hidden bg-gray-50",children:/\.pdf($|\?)/i.test(M)?e.jsx("iframe",{src:M,title:"Anteprima documento",className:"w-full h-[520px] bg-white"}):/\.(png|jpe?g|gif|webp)($|\?)/i.test(M)?e.jsx("div",{className:"w-full bg-white flex items-center justify-center",children:e.jsx("img",{src:M,alt:"Anteprima documento",className:"max-h-[520px] w-auto object-contain",loading:"lazy"})}):e.jsx("div",{className:"p-4 text-sm text-gray-600",children:"Tipo di file non supportato per l'anteprima"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Storico"}),Array.isArray(a.Storico)&&a.Storico.length>0?e.jsx("div",{className:"space-y-2",children:a.Storico.map((t,i)=>{const o=t.DataOra||t.Data||t.data||t.createdAt||"",d=t.Utente||t.user||t.Username||"",n=t.StatoPrecedenteNome??t.StatoPrecedente??t.from??t.da??"",c=t.StatoNuovoNome??t.StatoNuovo??t.to??t.a??"",b=t.Nota||t.note||"";return e.jsx("div",{className:"border border-gray-100 rounded p-2 text-xs bg-white",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Data"}),e.jsx("div",{className:"text-gray-800 whitespace-nowrap",children:We(o)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Utente"}),e.jsx("div",{className:"text-gray-800 break-all uppercase",children:d||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Da"}),e.jsx("div",{className:"text-gray-800 uppercase",children:n||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"A"}),e.jsx("div",{className:"text-gray-800 uppercase",children:c||"-"})]}),e.jsxs("div",{className:"sm:col-span-1 col-span-2",children:[e.jsx("div",{className:"text-[10px] text-gray-500",children:"Nota"}),e.jsx("div",{className:"text-gray-800 break-words uppercase",children:b||"-"})]})]})},i)})}):e.jsx("div",{className:"text-sm text-gray-500",children:"Nessuno storico disponibile"})]}),e.jsxs("div",{className:"border border-gray-200 rounded p-3 bg-gray-50",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Azioni"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:'Nota per Dealer (obbligatoria per Rimanda e "Ticket Gestito con Nota")'}),e.jsx("textarea",{value:v,onChange:t=>ee(t.target.value),rows:3,className:"w-full text-sm border border-gray-200 rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Inserisci una nota chiara e completa..."}),ce&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:ce})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:["1MOBILE_CONSUMER","1MOBILE_CONSUMER_NOMNP"].includes(String(a?.Template?.template||""))?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r||!v||!v.trim(),onClick:()=>F(3),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"Imposta ATTESA INTEGRAZIONE (stato 3). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:9,emailTemplateId:16,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"Imposta stato 9 (PDA IN ATTESA FIRMA) e invia email (template 16)",children:r?"Attendo...":"PDA IN ATTESA FIRMA"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:1,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"Imposta stato 1 (ATTIVATO) e invia email (template 11)",children:r?"Attendo...":"ATTIVATO"})]}):re?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>F(3),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:25,emailTemplateId:20,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"Imposta stato 25 e invia email TICKET IN LAVORAZIONE (template 20)",children:r?"Attendo...":"TICKET IN LAVORAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:22,emailTemplateId:21,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",title:"Imposta stato 22 e invia email TICKET GESTITO CON NOTA (template 21). Nota obbligatoria",children:r?"Attendo...":"TICKET GESTITO CON NOTA"})]}):Ne?e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:31,emailTemplateId:26,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-60",title:"Imposta stato 31 e invia email template 26 (PRENOTATO)",children:r?"Attendo...":"PRENOTATO"})}):je?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:15,emailTemplateId:22,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"RILANCIO ESEGUITO CONFERMARE MNP (stato 15 + email 22)",children:r?"Attendo...":"RILANCIO ESEGUITO CONFERMARE MNP"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"})]}):we?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:6,emailTemplateId:23,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"RESET ESEGUITO (stato 6 + email 23)",children:r?"Attendo...":"RESET ESEGUITO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:17,emailTemplateId:24,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"RESET IN GESTIONE (stato 17 + email 24)",children:r?"Attendo...":"RESET IN GESTIONE"})]}):Oe?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:16,emailTemplateId:23,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"RESET ESEGUITO (stato 16 + email 23)",children:r?"Attendo...":"RESET ESEGUITO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:17,emailTemplateId:24,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"RESET IN GESTIONE (stato 17 + email 24)",children:r?"Attendo...":"RESET IN GESTIONE"})]}):ye?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:10,emailTemplateId:17,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",title:"ATTESA MODULO (stato 10 + email 17)",children:r?"Attendo...":"ATTESA MODULO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:11,emailTemplateId:18,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"SIM SOSTITUITA (stato 11 + email 18)",children:r?"Attendo...":"SIM SOSTITUITA"})]}):Re?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:10,emailTemplateId:10,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"ATTESA MODULO (stato 10 + email 10)",children:r?"Attendo...":"ATTESA MODULO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:11,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"SIM SOSTITUITA (stato 11 + email 11)",children:r?"Attendo...":"SIM SOSTITUITA"})]}):ye?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:10,emailTemplateId:10,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"ATTESA MODULO (stato 10 + email 10)",children:r?"Attendo...":"ATTESA MODULO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:11,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"SIM SOSTITUITA (stato 11 + email 11)",children:r?"Attendo...":"SIM SOSTITUITA"})]}):De?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:27,emailTemplateId:34,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"SUBENTRO EFFETTUATO (stato 27 + email 34)",children:r?"Attendo...":"SUBENTRO EFFETTUATO"})]}):Ue?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:25,emailTemplateId:20,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"TICKET IN LAVORAZIONE (stato 25 + email 20)",children:r?"Attendo...":"TICKET IN LAVORAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:22,emailTemplateId:21,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",title:"TICKET GESTITO CON NOTA (stato 22 + email 21). Nota obbligatoria",children:r?"Attendo...":"TICKET GESTITO CON NOTA"})]}):Ce?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:6,emailTemplateId:13,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"TICKET APERTO (stato 6 + email 13)",children:r?"Attendo...":"TICKET APERTO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:12,emailTemplateId:19,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"CLIENTE ACQUISIBILE (stato 12 + email 19)",children:r?"Attendo...":"CLIENTE ACQUISIBILE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:20,emailTemplateId:27,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",title:"CLIENTE NON ACQUISIBILE (stato 20 + email 27). Nota obbligatoria",children:r?"Attendo...":"CLIENTE NON ACQUISIBILE"})]}):_e?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:21,emailTemplateId:13,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"TICKET IN LAVORAZIONE (stato 21 + email 13)",children:r?"Attendo...":"TICKET IN LAVORAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:22,emailTemplateId:21,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",title:"TICKET GESTITO CON NOTA (stato 22 + email 21). Nota obbligatoria",children:r?"Attendo...":"TICKET GESTITO CON NOTA"})]}):Fe?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:1,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"ATTIVATO (stato 1 + email 11)",children:r?"Attendo...":"ATTIVATO"})]}):ke?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:1,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"ATTIVATO (stato 1 + email 11)",children:r?"Attendo...":"ATTIVATO"})]}):Le?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:1,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"ATTIVATO (stato 1 + email 11)",children:r?"Attendo...":"ATTIVATO"})]}):Pe?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:1,emailTemplateId:11,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-700 text-white hover:bg-green-800 disabled:opacity-60",title:"ATTIVATO (stato 1 + email 11)",children:r?"Attendo...":"ATTIVATO"})]}):$e?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:14,emailTemplateId:21,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-blue-700 text-white hover:bg-blue-800 disabled:opacity-60",title:"GESTITO CON NOTA (stato 14 + email 21). Nota obbligatoria",children:r?"Attendo...":"GESTITO CON NOTA"})]}):Ne?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:31,emailTemplateId:26,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-indigo-700 text-white hover:bg-indigo-800 disabled:opacity-60",title:"PRENOTATO (stato 31 + email 26)",children:r?"Attendo...":"PRENOTATO"})]}):ve?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:3,emailTemplateId:7,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3 + email 7). Nota obbligatoria",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:6,emailTemplateId:13,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"TICKET APERTO (stato 6 + email 13)",children:r?"Attendo...":"TICKET APERTO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:12,emailTemplateId:19,requireNote:!1}),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"CLIENTE ACQUISIBILE (stato 12 + email 19)",children:r?"Attendo...":"CLIENTE ACQUISIBILE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>l({targetState:24,emailTemplateId:27,requireNote:!0}),className:"px-3 py-1.5 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-60",title:"CLIENTE NON ACQUISIBILE CON NOTA (stato 24 + email 27). Nota obbligatoria",children:r?"Attendo...":"CLIENTE NON ACQUISIBILE CON NOTA"})]}):Me?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>F(1),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"Imposta stato INSERITO (stato 1 - ATTIVATO)",children:r?"Attendo...":"INSERITO"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>F(3),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"IN ATTESA DI INTEGRAZIONE (stato 3)",children:r?"Attendo...":"IN ATTESA DI INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>F(32),className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",title:"IN LAVORAZIONE (stato 32)",children:r?"Attendo...":"IN LAVORAZIONE"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",disabled:r,onClick:()=>F(1),className:"px-3 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-700 disabled:opacity-60",title:"Imposta stato ATTIVATO",children:r?"Attendo...":"ATTIVA"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>F(3),className:"px-3 py-1.5 text-sm rounded bg-amber-600 text-white hover:bg-amber-700 disabled:opacity-60",title:"ATTESA INTEGRAZIONE (stato 3)",children:r?"Attendo...":"ATTESA INTEGRAZIONE"}),e.jsx("button",{type:"button",disabled:r,onClick:()=>F(2),className:"px-3 py-1.5 text-sm rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",title:"Rifiuta ordine (stato 2)",children:r?"Attendo...":"RIFIUTA"})]})}),e.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:re?"Carica FILE (PDF o immagini, max 10MB)":"Carica PDA (PDF o immagini, max 10MB)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"file",accept:"application/pdf,image/jpeg,image/jpg,image/png,image/webp",onChange:t=>Ge(t.target.files?.[0]||null),className:"text-sm"}),e.jsx("button",{type:"button",onClick:ze,disabled:me||!te,className:"px-3 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:me?"Caricamento...":re?"Carica FILE":"Carica PDA"})]}),ue&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:ue})]})]})]})]}),e.jsx("div",{className:"p-3 border-t border-gray-100 flex justify-end",children:e.jsx("button",{onClick:ie,className:"px-3 py-1.5 text-sm rounded bg-gray-100 hover:bg-gray-200 text-gray-700",children:"Chiudi"})})]})]})]})}function rt(){return e.jsx(Ve,{title:"Dashboard Master",children:e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"rounded-2xl bg-white p-8 sm:p-6 shadow-sm h-[calc(100vh-150px)] overflow-hidden flex flex-col",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Attivazioni"})}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx("div",{className:"h-full overflow-auto pr-1",children:e.jsx(Je,{})})})]})})})}export{rt as default};
